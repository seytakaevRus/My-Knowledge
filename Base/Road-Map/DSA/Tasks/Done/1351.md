---
level: easy
tags:
  - leetcode
linkToTask: https://leetcode.com/problems/count-negative-numbers-in-a-sorted-matrix/description/
topics:
  - matrix
recommended: true
---
## Описание

Дается матрица размерами `m x n`, которая отсортирована в убывающем порядке, как по строкам, так и по колонкам, вернуть количество отрицательных чисел в матрице.

Дополнительно: найти решение по времени за `O(n + m)`.

---
## Ограничения

- `m == grid.length`
- `n == grid[i].length`
- `1 <= m, n <= 100`
- `-100 <= grid[i][j] <= 100`

---
## Пример 1

### Входные данные

```
grid = [[4,3,2,-1],[3,2,1,-1],[1,1,-1,-2],[-1,-1,-2,-3]]
```
### Выходные данные

```
8
```
### Объяснение

```
There are 8 negatives number in the matrix.
```

---
## Пример 2

### Входные данные

```
grid = [[3,2],[1,0]]
```
### Выходные данные

```
0
```

---
## Решение 1

Здесь использована техника [[Бинарный поиск#Поиск начало или конец диапазона, где все элементы подходят под условие|Бинарный поиск, поиск начало или конец диапазона, где все элементы подходят под условие]].

Находим индекс первого отрицательного числа и вычисляем количество чисел в массиве. 

```typescript
const countNegatives = (grid: number[][]): number => {
  let count = 0;

  for (let i = 0; i < grid.length; i += 1) {
    const index = findIndexFirstNegativeNumber(grid[i]);

    if (index !== -1) {
      count += grid[i].length - index;
    }
  }

  return count;
};
```

Сложность по времени: `O(n log m)`, `n` - количество строк, `m` - количество столбцов.

Сложность по памяти: `O(1)`.

---
## Решение 2

Если отсортированы и колонки, и столбцы, то зачастую можно перебрать матрицу как лестницу.

На каждой строке мы начинаем перебор с конца определенного `index` и когда встречаем неотрицательный элемент, то считаем количество отрицательных элементов в строке и изменяем `index` на индекс неотрицательного элемента. Следующая строка начнет перебор с этого индекса.

Это можно представить в виде лестницы, где `+` - неотрицательное число, `-` - отрицательное число, а `*` - текущий индекс.

```
  *
+++---
  *
+++---
 *
++----
*
+-----
*
------
```

На случай, если в строке не оказалось неотрицательных элементов есть условие `if(j === 0)`, в этом случае просто прибавляем длину строки.

```typescript
const countNegatives = (grid: number[][]): number => {
  let count = 0;
  let index = grid[0].length - 1;

  for (let i = 0; i < grid.length; i += 1) {
    for (let j = index; j >= 0; j -= 1) {
      if (grid[i][j] >= 0) {
        index = j;

        count += grid[i].length - 1 - index;

        break;
      }

      if (j === 0) {
        count += grid[i].length;
      }
    }
  }

  return count;
};
```

Сложность по времени: `O(n + m)`.

Сложность по памяти: `O(1)`.

---
## Связанное

- [[240|Search a 2D Matrix ||]]
- [[2529|Maximum Count of Positive Integer and Negative Integer]]