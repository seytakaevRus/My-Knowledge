---
tags:
  - roadmap
refs:
  - https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API
date: 2024-03-31
author: Ruslan Seit-Akaev
---
`Fetch API` - предоставляет возможность создания запросов и получение ресурсов через Интернет посредством метода `fetch`. Это глобальный метод, который доступен в контексте `Window`.

Глобальный метод `fetch` начинает процесс получения ресурса через Интернет и возвращает промис, который выполняется, когда ответ доступен.

Промис, также может быть отменен, если запрос провалился, это может быть из-за неправильного формата URL-адреса или сетевой ошибки. 

> [!warning] 
 Промис не отклоняется, если сервер отвечает кодами состояния `HTTP`, которые указывают на ошибки (404, 504 и т.д.), вместо этого нужно смотреть на свойства `Response.ok` и `Response.status`.

## Синтаксис

```js
fetch(resource);
fetch(resource, options);
```

### Параметры

`resource`

  Определяет ресурс, который нужно запросить. Это может быть, либо строка, которая представляет из себя `URL` требуемого ресурса или объект `Request`;

`options`

  Объект, который содержит пользовательские настройки, которые будут применены к запросу. Доступные настройки:

- `body`
Здесь хранится информация, которую может получить сервер, текст, файл, буфер и т.д. Методы `GET` и `HEAD` не могут иметь `body`;
- `cache`
Строка, которая показывает, как запрос взаимодействует с браузерным `HTTP Cache`. TODO: Написать подробно про `HTTP Cache`;
- `credentials`
Контролирует, что браузер делает с кредами (куки, заголовками `Authorization` и `TLS` клиентскими сертификатами). Принимает одно из значений ниже:
	1. `omit` - говорит браузеру, чтобы он исключил креды из запроса и игнорировал любые креды, которые сервер отправляет в ответе (`Set-Cookie`);
	2. `same-origin` - говорит браузеру о включении кредов в запросы к [[CORS#Определение похожести источников|похожему источнику]] и использование кредов, которые присутствует в ответе, если они пришли от того же источника;
	3. `include` - говорит браузеры о включении кредов в запросы как к похожему источнику, так и к другим источникам, и также всегда принимает креды, которые сервер отправляет в ответе;
- `headers`
Любые заголовки, которые будут добавлены к запросу;
- `integrity`
[[Целостность подресурса]]
- `keepalive`
Этоn булевый атрибут позволяет держать запрос до тех пор, пока не выполнится, даже после закрытия документа. Если Интернет достаточно быстрый, то при закрытии страницы некоторые запросы все равно будут выполнены и без `keepalive`. Но в некоторых ситуациях этот атрибут просто необходим. Например, когда после закрытия документа скрипт на клиенте отправляет файл и он весит немало и/или Интернет медленный, то `keepalive` будет держать запрос до тех пор, пока файл не загрузится даже после закрытия документа.
- `method`
Указывает метод, который будет использоваться в запросе `GET`, `POST` или другие доступные методы. По умолчанию используется `GET`.
- `mode`
Режим, который будет использоваться:
	1. `cors` - стоит по умолчанию, позволяет делать запрос на другие источники;
	2. `same-origin` - запросы на другие источники запрещены;
	3. `no-cors` - разрешены только [[CORS#Простой запрос|простые запросы]] на другие источники, причем в таком режиме все методы, кроме `GET`, `POST` и `HEAD` будут блокироваться, а заголовки, которые не входят будут удаляться;
- `priority`
    Указывает приоритет запроса `fetch` относительно других запросов такого же типа. Принимает один из вариантов:
	1. `high` - высокий приоритет `fetch` запроса, относительно других запросов;
	2. `low` - низкий приоритет;
	3. `auto` - приоритет вычисляется автоматически.
- `redirect`
Указывает как обрабатывать запросы с перенаправлением, те у которых статус кода `301`, `302` и так далее.
	1. `follow` - автоматически следовать перенаправлением, по умолчанию стоит эта опция;
	2. `error` - ошибка в случае редиректа;
	3. `manual`- редирект не происходит, его можно сделать вручную.
- `referrer` - TODO: прочитать про `referrer` подробнее;
- `referrerPolicy` - TODO: прочитать про `referrerPolicy` подробнее.
- `signal` - TODO: Прочитать про `AbortController` и `AbortSignal`.

