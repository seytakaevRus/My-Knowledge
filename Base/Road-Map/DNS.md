`Доменное имя` - строка текста, которая сопоставляется с `IP-адресом`. Также это текст, который пользователь вводит в строку браузера, чтобы достичь определенного веб-сайта. 

Запоминать `IP-адрес` нужного нам сайта сложно, поэтому придумали `доменное имя` как псевдоним для адреса. К примеру доменное имя `google.com` это псевдоним IP адреса `142.250.190.78`.

В самих `DNS-серверах`, которые обслуживают определенные домены хранится информация о том, какому домену и его под доменам соответствует какой IP-адрес.

## Составляющие доменного имени

Доменные имена разделены на две, три или более частей, каждая отделена точкой. 

![[Pasted image 20240218232434.png]]

Расположение доменных имен идет справа-налево, от самого общего к самому специфичному.

`TLD (Top-Level Domain)` - сообщают пользователям общую цель услуги.
- `.us`, `.fr`, `.se` используются для определенной страны;
- `.gov` доступны только для правительственных департаментов;
- `.edu` используются только для образование и академических институтов.

`Надпись` - это то, что следует после `TLD`, надпись, которая идет сразу после домена (с правой стороны от него) называется `домен второго уровня`.

Доменные имена могут содержать в себе много надписей.

## Кто владеет доменными именами

Доменное имя купить нельзя, его можно только арендовать.

Компании, называемые `регистраторами`, используют `реестры доменных` имен для выдачи свободных доменных имен.

Это очень похоже на автосалон. Клиент, который заинтересован в покупке автомобиля, заходит в демонстрационный зал, сотрудники по продаже показывают доступные автомобили. Если клиент решает купить автомобиль (которого нет на складе), дилерский центр должен заказать автомобиль у производителя. Клиент в конечном счете забирает автомобиль и получает обслуживание из дилерского центра.

`Регистратор` похож на дилерский центр доменных имен, а реестр - на производителя. `Регистратор` содействует осуществлению операций и оказывает вспомогательные услуги, а реестр отвечает за производство и доставку товаров. Следует отметить, что ключевое различие между регистрацией домена и покупкой автомобиля заключается в том, что автомобили могут принадлежать потребителям, а доменные имена - нет.

`Реестр` - владеет всеми своими доменными именами.
`Регистратор` - предлагает клиентам возможность зарегистрировать эти доменные имена в течение ограниченного периода времени.

## Обновление DNS

Базы данных `DNS` хранятся на каждом` DNS-сервере` по всему миру, все эти сервера связаны с несколькими главными `DNS-серверами`, которые управляют системой.

Всякий раз, когда ваш регистратор создает или обновляет какую-либо информацию для данного домена, эта информация должна обновляться в каждой базе данных `DNS`. Каждый `DNS-сервер`, который знает о данном домене, хранит информацию в течение некоторого времени, прежде чем она автоматически становится недействительной, а затем обновляется (`DNS-сервер` запрашивает у главного сервера и получает от него обновленную информацию). Таким образом, `DNS-серверам`, знающим об этом доменном имени, требуется некоторое время, чтобы получить актуальную информацию.

## DNS запрос (без подробностей)

Когда мы вводим в строку браузера домен, то происходит следующее:
1.  Компьютер уже может знать `IP-адрес`, подсмотрев его в локальном `DNS кэш`, после этого он запрашивает страницу у `веб-сервера`, так как знает его `IP`.
2. Другой вариант, когда компьютер не знает `IP`, тогда н обращается к ближайшему `DNS-серверу`, чья работа заключается в том, чтобы дать `IP-адрес` `веб-сервера`, который скрывается за доменом;
3. Теперь браузер знает `IP` и посылает запрос.
![[Pasted image 20240218235122.png]]

## DNS запрос (с подробностями)

![[Pasted image 20240224125507.png]]

`Резолвить` - найти IP-адрес, который закреплен за доменным именем.

1. Пользователь вводит `faq-reg.ru` в веб-браузер. Браузер пытается зарезолвить при помощи кэша, он ищет в:
	- кэше браузере;
	- DNS кэше;
	- файл `Hosts`, в нем задается соответствие домена IP-адресу.
	Если информация была найдена, то сайт сразу откроется (`стрелка 9`). Если нет, то браузер сформирует DNS-запрос к интернет-провайдеру (`recursive DNS resolver`) (`стрелка 1`);
2. У интернет-провайдера есть кэш с предыдущих запросов других пользователей. Если такая запись есть, браузер получит IP-адрес (`стрелка 8`). По этому адресу браузер сможет обратиться к хостингу, где расположен сайт и пользователю откроется страница в браузере (`стрелка 9`). Если запись у интернет-провайдера отсутствует, то он перенаправит запрос на корневой (главный) DNS-сервер (`DNS root server`) (`стрелка 2`);
3. Корневые DNS-сервера хранят информацию только о DNS-серверах, ответственных за доменные зоны. Этот сервер не может предоставить провайдеру IP-адрес запрашиваемого домена, зато он может отправить IP-адрес DNS-сервера, который ответственен за доменную зону, в данному случае зона `.ru` (`стрелка 3`);
4. Теперь у интернет-провайдера есть IP-адрес DNS-сервера доменной зоны `.ru`, поэтому он обращается к нему (`стрелка 4`);
5. DNS-сервера зоны (`DNS TLD Nameserver`) хранят информацию о DNS-серверах всех доменов в этой зоне, но не их IP-адрес. Поэтому DNS-серверы зоны подскажут интернет-провайдеру IP-адрес DNS-сервера домена `faq-reg.ru` (`стрелка 5`);
6. Интернет-провайдер получил IP-адрес DNS-сервера домена `faq-reg.ru`. Он обращается к DNS-серверу домена (например, к `ns1.hosting.reg.ru` (`Authoritative nameserver`)) с запросом IP-адреса домена (`стрелка 6`);
7. После получения запроса DNS-сервер сначала проверяет, есть ли у него информация о домене `faq-reg.ru` и искомый IP-адрес для него. В случае успеха DNS-сервер отправит IP-адрес домена интернет-провайдеру (`стрелка 7`);
8. Интернет-провайдер получает IP-адрес домена и сохраняет его у себя в кеше. После этого он отправит браузеру результат DNS-запроса — IP-адрес домена `faq-reg.ru` (`стрелка 8`);
9. Браузер обращается к хостингу по полученному IP-адресу (`стрелка 9`). Теперь пользователю открывается запрашиваемый сайт `faq-reg.ru`.

Если у запрашиваемого доменного имени будет больше доменов, к примеру, `www.faq-reg.ru`, то шагов будет больше, так как после получения информации о `ru`, затем `faq-reg.ru` нужно будет получить информацию о домене `www.faq-reg.ru`. И потом можно вернуть его IP-адрес интернет провайдеру.

## Где находятся DNS-cервера

Основой DNS-системы являются `корневые сервера`, которых всего `13`. Чтобы повысить устойчивость системы, были созданы их копии в разных странах. Каждой копии присваивается тот же IP DNS-сервера, что и у главного устройства.

## Зачем прописывать DNS-серверы для домена

Допустим, ты зарегистрировал домен. Пока никто, кроме тебя, об этом не знает. Чтобы о существовании твоего домена узнал интернет, нужно выбрать и прописать для домена DNS-серверы. Они-то и расскажут другим DNS-серверам интернета о вашем домене. Так что запоминай `зарегистрировал домен — пропиши DNS-серверы`!

Прописывают DNS-серверы чаще всего парами. Один из DNS является первичным, а остальные серверы, которых может быть от 1 до 12 для каждого домена, называются вторичными. Это делается для лучшей отказоустойчивости: если выйдет из строя первичный DNS-сервер, домен и сайт продолжат свою работу благодаря вторичным.

## Виды DNS записей

Здесь можно поиграть с DNS записями https://messwithdns.net/.
### A запись

Запись такого типа хранит IP-адрес веб-ресурса, который соответствует определенному имени домена.
### CNAME запись

Запись такого типа указывает на домен/поддомен другого домена, в отличие от IP-адреса в записи A. Чаще всего используется для создание псевдонимов на доменное имя.
### MX запись

Запись хранит адрес почтового сервера.
### TXT запись

Запись хранит любую текстовую информацию о домене.
### NS запись

Запись хранит адрес авторитетного сервера имен, то есть того сервера, который резолвит текущее доменое имя на IP-адрес.



